<!DOCTYPE html>









<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en"
  
    data-mode="light"
  
>

  <!--
  The Head
-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  

    

    

  

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="RipsTech PHP Security Calendar 2017 Notes" />
<meta name="author" content="snoopysecurity" />
<meta property="og:locale" content="en" />
<meta name="description" content="Notes related to RipsTech PHP Security Calendar 2017 which aren‚Äôt accessible anymore." />
<meta property="og:description" content="Notes related to RipsTech PHP Security Calendar 2017 which aren‚Äôt accessible anymore." />
<link rel="canonical" href="http://localhost:4000/posts/ripstech_2017_security_calendar/" />
<meta property="og:url" content="http://localhost:4000/posts/ripstech_2017_security_calendar/" />
<meta property="og:site_name" content="üíª Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-03-24T03:25:52+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="RipsTech PHP Security Calendar 2017 Notes" />
<meta name="twitter:site" content="@snoopysecurity" />
<meta name="twitter:creator" content="@snoopysecurity" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"snoopysecurity"},"dateModified":"2018-03-24T03:25:52+08:00","datePublished":"2018-03-24T03:25:52+08:00","description":"Notes related to RipsTech PHP Security Calendar 2017 which aren‚Äôt accessible anymore.","headline":"RipsTech PHP Security Calendar 2017 Notes","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/ripstech_2017_security_calendar/"},"url":"http://localhost:4000/posts/ripstech_2017_security_calendar/"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>RipsTech PHP Security Calendar 2017 Notes | üíª | Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="üíª | Blog">
<meta name="application-name" content="üíª | Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  

    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/style.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script>

  
</head>


  <body data-spy="scroll" data-target="#toc" data-topbar-visible="true">

    <!--
  The Side Bar
-->

<div id="sidebar" class="d-flex flex-column align-items-end">
  <div class="profile-wrapper text-center">
    <div id="avatar">
      <a href="/" class="mx-auto">
        
          
          <img src="/assets/img/blog/pic1.jpeg" alt="avatar" onerror="this.style.display='none'">
        
      </a>
    </div>

    <div class="site-title">
      <a href="/">üíª | Blog</a>
    </div>
    <div class="site-subtitle font-italic">learning security while segfaulting through life</div>

  </div><!-- .profile-wrapper -->

  <ul class="w-100">

    <!-- home -->
    <li class="nav-item">
      <a href="/" class="nav-link">
        <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i>
        <span>HOME</span>
      </a>
    </li>
    <!-- the real tabs -->
    
    <li class="nav-item">
      <a href="/categories/" class="nav-link">
        <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>CATEGORIES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/tags/" class="nav-link">
        <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>TAGS</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/archives/" class="nav-link">
        <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ARCHIVES</span>
      </a>
    </li> <!-- .nav-item -->
    
    <li class="nav-item">
      <a href="/about/" class="nav-link">
        <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i>
        

        <span>ABOUT</span>
      </a>
    </li> <!-- .nav-item -->
    

  </ul> <!-- ul.nav.flex-column -->

  <div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center">

    

    
      

      
      <a href="https://github.com/snoopysecurity" aria-label="github"
        
        
          
          target="_blank"
        

        

        rel="noopener">
        <i class="fab fa-github"></i>
      </a>
      

    
      

      
      <a href="https://twitter.com/snoopysecurity" aria-label="twitter"
        
        
          
          target="_blank"
        

        

        rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
      

    
      

      
      <a href="
          javascript:location.href = 'mailto:' + ['example','domain.com'].join('@')" aria-label="email"
        
        

        

        >
        <i class="fas fa-envelope"></i>
      </a>
      

    
      

      
      <a href="/feed.xml" aria-label="rss"
        
        

        

        >
        <i class="fas fa-rss"></i>
      </a>
      

    
      

      
      <a href="" aria-label="linkedin"
        
        
          
          target="_blank"
        

        

        rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
      

    

  </div> <!-- .sidebar-bottom -->

</div><!-- #sidebar -->


    <!--
  The Top Bar
-->

<div id="topbar-wrapper">
  <div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4">
    <span id="breadcrumb">

    

    

      

        
          <span>
            <a href="/">
              Home
            </a>
          </span>

        

      

        

      

        

          
            <span>RipsTech PHP Security Calendar 2017 Notes</span>
          

        

      

    

    </span><!-- endof #breadcrumb -->

    <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i>

    <div id="topbar-title">
      Post
    </div>

    <i id="search-trigger" class="fas fa-search fa-fw"></i>
    <span id="search-wrapper" class="align-items-center">
      <i class="fas fa-search fa-fw"></i>
      <input class="form-control" id="search-input" type="search"
        aria-label="search" autocomplete="off" placeholder="Search...">
    </span>
    <span id="search-cancel" >Cancel</span>
  </div>

</div>


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div id="main" class="container pl-xl-4 pr-xl-4">
        





<div class="row">

  <!-- core -->
  <div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4">
    <div class="post pl-1 pr-1 pl-md-2 pr-md-2">

    

    
      
      
        <!--
  Refactor the HTML structure.
-->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- return -->

<h1 data-toc-skip>RipsTech PHP Security Calendar 2017 Notes</h1>

<div class="post-meta text-muted">
    <!-- published date -->
    <span>
      Posted
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class=""
    data-ts="1521833152"
    data-df="ll"
    data-toggle="tooltip" data-placement="bottom">
  Mar 24, 2018
</em>

    </span>

    <!-- lastmod date -->
    

  

  <div class="d-flex justify-content-between">
    <!-- author(s) -->
    <span>
      

      By

      <em>
      
        
          <a href=""></a>
          
        
      
      </em>
    </span>

    <div>
      <!-- page views -->
      

      <!-- read time -->
      <!--
  Calculate the post's reading time, and display the word count in tooltip
 -->



<!-- words per minute  -->










<!-- return element -->
<span class="readtime" data-toggle="tooltip" data-placement="bottom"
  title="5257 words">
  <em>29 min</em> read</span>

    </div>

  </div> <!-- .d-flex -->

</div> <!-- .post-meta -->

<div class="post-content">
  <p>Notes related to RipsTech PHP Security Calendar 2017 which aren‚Äôt accessible anymore.</p>

<h3 id="challenge-1---wishlist"><span class="mr-2">Challenge 1 - Wishlist</span><a href="#challenge-1---wishlist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>class Challenge {
    const UPLOAD_DIRECTORY = './solutions/';
    private $file;
    private $whitelist;

    public function __construct($file) {
        $this-&gt;file = $file;
        $this-&gt;whitelist = range(1, 24);
    }

    public function __destruct() {
        if (in_array($this-&gt;file['name'], $this-&gt;whitelist)) {
            move_uploaded_file(
                $this-&gt;file['tmp_name'],
                self::UPLOAD_DIRECTORY . $this-&gt;file['name']
            );
        }
    }
}

$challenge = new Challenge($_FILES['solution']);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The vulnerability allows arbitrary file uploads, identified at line 13.</li>
  <li>At line 12, in_array() is used to verify if the file name matches a number.</li>
  <li>However, this check is not type-safe because the third parameter in in_array() is not set to true.</li>
  <li>As a result, PHP will type-cast the file name to an integer when comparing it to the $whitelist array at line 8.</li>
  <li>This allows bypassing the whitelist by prepending a number between 1 and 24 to the file name, such as ‚Äú5backdoor.php‚Äù.</li>
  <li>Successfully uploading this PHP file could lead to code execution on the server.</li>
</ul>

<p>Challenge 2 - Twig</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>// composer require "twig/twig"
require 'vendor/autoload.php';

class Template {
    private $twig;

    public function __construct() {
        $indexTemplate = '&lt;img ' .
            'src="https://loremflickr.com/320/240"&gt;' .
            '&lt;a href=""&gt;Next slide ¬ª&lt;/a&gt;';

        // Default twig setup, simulate loading
        // index.html file from disk
        $loader = new Twig\Loader\ArrayLoader([
            'index.html' =&gt; $indexTemplate
        ]);
        $this-&gt;twig = new Twig\Environment($loader);
    }

    public function getNexSlideUrl() {
        $nextSlide = $_GET['nextSlide'];
        return filter_var($nextSlide, FILTER_VALIDATE_URL);
    }

    public function render() {
        echo $this-&gt;twig-&gt;render(
            'index.html',
            ['link' =&gt; $this-&gt;getNexSlideUrl()]
        );
    }
}

(new Template())-&gt;render();
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>A cross-site scripting (XSS) vulnerability exists at line 26.</li>
  <li>Two filters aim to ensure the link passed to the <a> tag is a legitimate URL:</a></li>
  <li>filter_var() at line 22 checks for a valid URL.</li>
  <li>Twig‚Äôs template escaping at line 10 helps prevent breaking out of the href attribute.</li>
  <li>The vulnerability is still exploitable using a crafted URL like: <code class="language-plaintext highlighter-rouge">?nextSlide=javascript://comment%250aalert(1)</code>.</li>
  <li>This payload contains no markup characters that Twig‚Äôs escaping would filter out and is also considered a valid URL by <code class="language-plaintext highlighter-rouge">filter_var()</code>.</li>
  <li>The payload uses a JavaScript protocol handler with a comment (//), followed by the JavaScript payload on a new line.</li>
  <li>When the link is clicked, the JavaScript code executes in the victim‚Äôs browser.</li>
</ul>

<h3 id="challenge-3---snowflake"><span class="mr-2">Challenge 3 - Snowflake</span><a href="#challenge-3---snowflake" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>function __autoload($className) {
    include $className;
}

$controllerName = $_GET['c'];
$data = $_GET['d'];

if (class_exists($controllerName)) {
    $controller = new $controllerName($data['t'], $data['v']);
    $controller-&gt;render();
} else {
    echo 'There is no page with this name';
}

class HomeController {
    private $template;
    private $variables;

    public function __construct($template, $variables) {
        $this-&gt;template = $template;
        $this-&gt;variables = $variables;
    }

    public function render() {
        if ($this-&gt;variables['new']) {
            echo 'controller rendering new response';
        } else {
            echo 'controller rendering old response';
        }
    }
}
</pre></td></tr></tbody></table></code></div></div>

<p>This code contains two security vulnerabilities:</p>

<ol>
  <li>File Inclusion Vulnerability</li>
</ol>

<ul>
  <li>Triggered by the class_exists() call at line 8, which checks for the existence of a user-supplied class name.</li>
  <li>This call invokes the custom autoloader at line 1 when the class name is unknown, leading to an attempt to include unknown classes.</li>
  <li>An attacker can exploit this with a path traversal attack, for instance, by providing ../../../../etc/passwd as the class name to leak the system‚Äôs passwd file.</li>
  <li>This vulnerability affects PHP versions up to 5.3.</li>
</ul>

<ol>
  <li>Arbitrary Object Instantiation</li>
</ol>

<ul>
  <li>At line 9, the user-controlled class name is used to instantiate a new object, with the first argument of its constructor also under the attacker‚Äôs control.</li>
  <li>This enables the invocation of arbitrary constructors within the PHP codebase.</li>
  <li>Even if the code does not have a vulnerable constructor, PHP‚Äôs built-in SimpleXMLElement class can be used to initiate an XXE attack, potentially exposing sensitive files.</li>
</ul>

<p>Example real world case: <a href="https://web.archive.org/web/20171224161253/https://blog.ripstech.com/2017/shopware-php-object-instantiation-to-blind-xxe/">shopware-php-object-instantiation-to-blind-xxe</a></p>

<p>### Challenge 4 - False Beard</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre> class Login {
    public function __construct($user, $pass) {
        $this-&gt;loginViaXml($user, $pass);
    }

    public function loginViaXml($user, $pass) {
        if (
            (!strpos($user, '&lt;') || !strpos($user, '&gt;')) &amp;&amp;
            (!strpos($pass, '&lt;') || !strpos($pass, '&gt;'))
        ) {
            $format = '&lt;?xml version="1.0"?&gt;' .
                      '&lt;user v="%s"/&gt;&lt;pass v="%s"/&gt;';
            $xml = sprintf($format, $user, $pass);
            $xmlElement = new SimpleXMLElement($xml);
            // Perform the actual login.
            $this-&gt;login($xmlElement);
        }
    }
}

new Login($_POST['username'], $_POST['password']);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>An XML injection vulnerability exists at line 14, allowing an attacker to manipulate the XML structure and bypass authentication.</li>
  <li>Lines 8 and 9 attempt to prevent exploitation by checking for angle brackets, but this check can be bypassed with a carefully crafted payload.</li>
  <li>The vulnerability is due to PHP‚Äôs automatic type-casting:</li>
  <li>The strpos() function returns the numeric position of the searched character, which can be 0 if the first character matches.</li>
  <li>This 0 value is then type-cast to boolean false in the if comparison, causing the condition to evaluate as true.</li>
  <li>A sample payload might look like: <code class="language-plaintext highlighter-rouge">user=&lt;"&gt;&lt;injected-tag%20property="&amp;pass;=&lt;injected-tag&gt;</code>.</li>
</ul>

<h3 id="challenge-5---postcard"><span class="mr-2">Challenge 5 - Postcard</span><a href="#challenge-5---postcard" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre></td><td class="rouge-code"><pre>class Mailer {
    private function sanitize($email) {
        if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
            return '';
        }

        return escapeshellarg($email);
    }

    public function send($data) {
        if (!isset($data['to'])) {
            $data['to'] = 'none@ripstech.com';
        } else {
            $data['to'] = $this-&gt;sanitize($data['to']);
        }

        if (!isset($data['from'])) {
            $data['from'] = 'none@ripstech.com';
        } else {
            $data['from'] = $this-&gt;sanitize($data['from']);
        }

        if (!isset($data['subject'])) {
            $data['subject'] = 'No Subject';
        }

        if (!isset($data['message'])) {
            $data['message'] = '';
        }

        mail($data['to'], $data['subject'], $data['message'],
             '', "-f" . $data['from']);
    }
}

$mailer = new Mailer();
$mailer-&gt;send($_POST);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>A command execution vulnerability exists at line 31, where the $_POST[‚Äòfrom‚Äô] variable is appended as the fifth parameter in the mail() function, allowing it to modify the sendmail command.</li>
  <li>Although arbitrary commands cannot be executed, an attacker can append new parameters to sendmail, potentially creating a PHP backdoor via sendmail log files.</li>
  <li>Insufficient Protections Against Exploitation - Two protections aim to prevent this exploit, but they are inadequate:</li>
  <li>The sanitize() function first checks if the email address is valid at line 3. However, the filter does not block all characters required for exploiting the mail() function, allowing escaped whitespaces within double quotes.</li>
  <li>At line 7, escapeshellarg() sanitizes the email address, which would normally suffice. However, PHP‚Äôs internal escape of the fifth parameter with escapeshellcmd() allows the attacker to bypass escapeshellarg() by escaping out of it.</li>
</ul>

<h3 id="challenge-6---frost-pattern"><span class="mr-2">Challenge 6 - Frost Pattern</span><a href="#challenge-6---frost-pattern" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>class TokenStorage {
    public function performAction($action, $data) {
        switch ($action) {
            case 'create':
                $this-&gt;createToken($data);
                break;
            case 'delete':
                $this-&gt;clearToken($data);
                break;
            default:
                throw new Exception('Unknown action');
        }
    }

    public function createToken($seed) {
        $token = md5($seed);
        file_put_contents('/tmp/tokens/' . $token, '...data');
    }

    public function clearToken($token) {
        $file = preg_replace("/[^a-z.-_]/", "", $token);
        unlink('/tmp/tokens/' . $file);
    }
}

$storage = new TokenStorage();
$storage-&gt;performAction($_GET['action'], $_GET['data']);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>A file delete vulnerability exists in this code.</li>
  <li>The issue is caused by an unescaped hyphen (-) in the regular expression used in the preg_replace() call at line 21.</li>
  <li>Without escaping, the hyphen acts as a range indicator, replacing any character not in a-z or within the ASCII range from dot (46) to underscore (95).</li>
  <li>This allows directory traversal using . and /, enabling an attacker to delete (almost) arbitrary files.</li>
  <li>For example, the parameters <code class="language-plaintext highlighter-rouge">action=delete&amp;data=../../config.php</code> could delete the config.php file.</li>
</ul>

<h3 id="challenge-7---bells"><span class="mr-2">Challenge 7 - Bells</span><a href="#challenge-7---bells" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>function getUser($id) {
    global $config, $db;
    if (!is_resource($db)) {
        $db = new MySQLi(
            $config['dbhost'],
            $config['dbuser'],
            $config['dbpass'],
            $config['dbname']
        );
    }
    $sql = "SELECT username FROM users WHERE id = ?";
    $stmt = $db-&gt;prepare($sql);
    $stmt-&gt;bind_param('i', $id);
    $stmt-&gt;bind_result($name);
    $stmt-&gt;execute();
    $stmt-&gt;fetch();
    return $name;
}

$var = parse_url($_SERVER['HTTP_REFERER']);
parse_str($var['query']);
$currentUser = getUser($id);
echo '&lt;h1&gt;'.htmlspecialchars($currentUser).'&lt;/h1&gt;';
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>A connection string injection vulnerability exists at line 4.</li>
  <li>This issue arises from the <code class="language-plaintext highlighter-rouge">parse_str()</code> call at line 21, which behaves similarly to register_globals.</li>
  <li>The parse_str() function extracts query parameters from the referrer as variables in the current scope, allowing control over the global $config variable within <code class="language-plaintext highlighter-rouge">getUser()</code> (lines 5‚Äì8).</li>
  <li>This vulnerability allows an attacker to connect to a malicious MySQL server and return arbitrary values for the username.
For example, using a referrer like <code class="language-plaintext highlighter-rouge">http://host/?config[dbhost]=10.0.0.5&amp;config[dbuser]=root&amp;config[dbpass]=root&amp;config[dbname]=malicious&amp;id=1</code> enables this attack.</li>
</ul>

<h3 id="challenge-8---candle"><span class="mr-2">Challenge 8 - Candle</span><a href="#challenge-8---candle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>header("Content-Type: text/plain");

function complexStrtolower($regex, $value) {
    return preg_replace(
        '/(' . $regex . ')/ei',
        'strtolower("\\1")',
        $value
    );
}

foreach ($_GET as $regex =&gt; $value) {
    echo complexStrtolower($regex, $value) . "\n";
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>A code injection vulnerability is present at line 4 due to the behavior of preg_replace() in versions of PHP prior to 7.</li>
  <li>In these versions, preg_replace() includes an eval modifier (e), which treats the replacement (second parameter) as PHP code if enabled.</li>
  <li>Although direct injection into the second parameter isn‚Äôt possible, the <code class="language-plaintext highlighter-rouge">\\1</code> placeholder (representing the matched expression) can be controlled.</li>
  <li>While it‚Äôs not possible to escape the strtolower() function call, the matched value is within double quotes, allowing the use of PHP‚Äôs curly syntax for injecting additional function calls.</li>
  <li>An example attack payload could look like: <code class="language-plaintext highlighter-rouge">/?=.*={${phpinfo()}}</code>, enabling execution of <code class="language-plaintext highlighter-rouge">phpinfo()</code>.</li>
</ul>

<h3 id="challenge-9---rabbit"><span class="mr-2">Challenge 9 - Rabbit</span><a href="#challenge-9---rabbit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>class LanguageManager
{
    public function loadLanguage()
    {
        $lang = $this-&gt;getBrowserLanguage();
        $sanitizedLang = $this-&gt;sanitizeLanguage($lang);
        require_once("/lang/$sanitizedLang");
    }

    private function getBrowserLanguage()
    {
        $lang = $_SERVER['HTTP_ACCEPT_LANGUAGE'] ?? 'en';
        return $lang;
    }

    private function sanitizeLanguage($language)
    {
        return str_replace('../', '', $language);
    }
}

(new LanguageManager())-&gt;loadLanguage();
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li>A file inclusion vulnerability exists, which could allow an attacker to execute arbitrary code or leak sensitive files on the server.</li>
  <li>The issue is found in the sanitization function at line 18, where the <code class="language-plaintext highlighter-rouge">../</code> string is replaced but not recursively.</li>
  <li>This failure allows an attacker to use alternate sequences like <code class="language-plaintext highlighter-rouge">....//</code> or <code class="language-plaintext highlighter-rouge">..././</code>, which will still resolve to <code class="language-plaintext highlighter-rouge">../</code> after replacement.</li>
  <li>As a result, the attacker can perform path traversal and manipulate the path to the included language file.</li>
  <li>For example, the system‚Äôs <code class="language-plaintext highlighter-rouge">passwd</code> file can be leaked by setting the following payload in the <code class="language-plaintext highlighter-rouge">Accept-Language</code> HTTP request header: <code class="language-plaintext highlighter-rouge">.//....//....//etc/passwd</code>.</li>
</ul>

<h3 id="challenge-10---anticipation"><span class="mr-2">Challenge 10 - Anticipation</span><a href="#challenge-10---anticipation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>extract($_POST);

function goAway() {
    error_log("Hacking attempt.");
    header('Location: /error/');
}

if (!isset($pi) || !is_numeric($pi)) {
    goAway();
}

if (!assert("(int)$pi == 3")) {
    echo "This is not pi.";
} else {
    echo "This might be pi.";
}
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>A code injection vulnerability exists at line 12, allowing an attacker to execute arbitrary PHP code on the web server.</li>
  <li>The <code class="language-plaintext highlighter-rouge">assert()</code> function evaluates PHP code and contains user input, creating the potential for malicious code execution.</li>
  <li>At line 1, PHP‚Äôs built-in <code class="language-plaintext highlighter-rouge">extract()</code> function instantiates all POST parameters as global variables, which can lead to security issues by exposing input directly as variables.</li>
  <li>In this challenge, the vulnerability allows the attacker to set the <code class="language-plaintext highlighter-rouge">$pi</code> variable directly via a POST parameter.</li>
  <li>At line 8, there is a check to ensure the input is numeric. If not, the user is redirected to an error page via the <code class="language-plaintext highlighter-rouge">goAway()</code> function.</li>
  <li>However, after the redirect in line 5, the script continues execution because there is no <code class="language-plaintext highlighter-rouge">exit()</code> call, allowing the attacker to inject and execute PHP code in the <code class="language-plaintext highlighter-rouge">$pi</code> parameter.</li>
  <li>For example, setting <code class="language-plaintext highlighter-rouge">pi=phpinfo()</code> will cause the <code class="language-plaintext highlighter-rouge">phpinfo()</code> function to execute.</li>
</ul>

<h3 id="challenge-11---pumpkin-pie"><span class="mr-2">Challenge 11 - Pumpkin Pie</span><a href="#challenge-11---pumpkin-pie" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre>class Template {
    public $cacheFile = '/tmp/cachefile';
    public $template = '&lt;div&gt;Welcome back %s&lt;/div&gt;';

    public function __construct($data = null) {
        $data = $this-&gt;loadData($data);
        $this-&gt;render($data);
    }

    public function loadData($data) {
        if (substr($data, 0, 2) !== 'O:'
        &amp;&amp; !preg_match('/O:\d:\/', $data)) {
            return unserialize($data);
        }
        return [];
    }

    public function createCache($file = null, $tpl = null) {
        $file = $file ?? $this-&gt;cacheFile;
        $tpl = $tpl ?? $this-&gt;template;
        file_put_contents($file, $tpl);
    }

    public function render($data) {
        echo sprintf(
            $this-&gt;template,
            htmlspecialchars($data['name'])
        );
    }

    public function __destruct() {
        $this-&gt;createCache();
    }
}

new Template($_COOKIE['data']);
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li>
    <p>This challenge contains a PHP object injection vulnerability, found at line 13, where an attacker can pass user input into the <code class="language-plaintext highlighter-rouge">unserialize()</code> function by modifying their cookie data.</p>
  </li>
  <li>There are two checks at lines 11 and 12 to prevent object deserialization:
    <ol>
      <li>The first check can be easily bypassed by injecting an object into an array, resulting in a payload string that begins with <code class="language-plaintext highlighter-rouge">a:1:</code> instead of <code class="language-plaintext highlighter-rouge">O:</code>.</li>
      <li>The second check can be bypassed by exploiting PHP‚Äôs flexible serialization syntax, using <code class="language-plaintext highlighter-rouge">O:+1:</code> to bypass the regex check.</li>
    </ol>
  </li>
  <li>
    <p>This allows the attacker to inject an object of class <code class="language-plaintext highlighter-rouge">Template</code> into the application.</p>
  </li>
  <li>
    <p>After the serialized object is deserialized and the <code class="language-plaintext highlighter-rouge">Template</code> object is instantiated, its destructor is triggered when the script terminates (line 31).</p>
  </li>
  <li>
    <p>The attacker-controlled properties, <code class="language-plaintext highlighter-rouge">cacheFile</code> and <code class="language-plaintext highlighter-rouge">template</code>, are used in line 21 to write to a file, enabling the creation of arbitrary files on the system.</p>
  </li>
  <li>
    <p>For example, an attacker can create a PHP shell in the document root with the payload:<br />
<code class="language-plaintext highlighter-rouge">a:1:{i:0;O:%2b8:"Template":2:{s:9:"cacheFile";s:14:"/var/www/a.php";s:8:"template";s:16:"&lt;?php%20phpinfo();";}}</code></p>
  </li>
  <li>More information about this attack can be found in <a href="https://web.archive.org/web/20171224161253/https://blog.ripstech.com/tags/php-object-injection/">this blog post</a>.</li>
</ul>

<h3 id="challenge-12---string-lights"><span class="mr-2">Challenge 12 - String Lights</span><a href="#challenge-12---string-lights" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>$sanitized = [];

foreach ($_GET as $key =&gt; $value) {
    $sanitized[$key] = intval($value);
}

$queryParts = array_map(function ($key, $value) {
    return $key . '=' . $value;
}, array_keys($sanitized), array_values($sanitized));

$query = implode('&amp;', $queryParts);

echo "&lt;a href='/images/size.php?" .
    htmlentities($query) . "'&gt;link&lt;/a&gt;";
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li>
    <p>This challenge contains a cross-site scripting (XSS) vulnerability, found at line 13.</p>
  </li>
  <li>
    <p>The issue arises from the insufficient sanitization of the keys in the <code class="language-plaintext highlighter-rouge">$_GET</code> array (the GET parameter names).</p>
  </li>
  <li>
    <p>Both the keys and sanitized GET values are concatenated into the <code class="language-plaintext highlighter-rouge">href</code> attribute of the <code class="language-plaintext highlighter-rouge">&lt;a&gt;</code> tag.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">htmlentities()</code> function is used to sanitize the input, but it does not affect single quotes by default.</p>
  </li>
  <li>
    <p>As a result, an attacker can exploit this by injecting an XSS payload into the parameter name, which breaks the <code class="language-plaintext highlighter-rouge">href</code> attribute and appends a JavaScript event handler.</p>
  </li>
  <li>
    <p>For example, the following query parameter can be used:<br />
<code class="language-plaintext highlighter-rouge">/a'onclick%3dalert(1)%2f%2f=c</code></p>
  </li>
  <li>
    <p>The payload is placed in the parameter name, not the parameter value, allowing the attacker to execute JavaScript in the user‚Äôs browser.</p>
  </li>
</ul>

<h3 id="challenge-13---turkey-blaster"><span class="mr-2">Challenge 13 - Turkey Blaster</span><a href="#challenge-13---turkey-blaster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre></td><td class="rouge-code"><pre>class LoginManager {
    private $em;
    private $user;
    private $password;

    public function __construct($user, $password) {
        $this-&gt;em = DoctrineManager::getEntityManager();
        $this-&gt;user = $user;
        $this-&gt;password = $password;
    }

    public function isValid() {
        $user = $this-&gt;sanitizeInput($this-&gt;user);
        $pass = $this-&gt;sanitizeInput($this-&gt;password);
        
        $queryBuilder = $this-&gt;em-&gt;createQueryBuilder()
            -&gt;select("COUNT(p)")
            -&gt;from("User", "u")
            -&gt;where("user = '$user' AND password = '$pass'");
        $query = $queryBuilder-&gt;getQuery();
        return boolval($query-&gt;getSingleScalarResult());
    }
	
    public function sanitizeInput($input, $length = 20) {
        $input = addslashes($input);
        if (strlen($input) &gt; $length) {
            $input = substr($input, 0, $length);
        }
        return $input;
    }
}

$auth = new LoginManager($_POST['user'], $_POST['passwd']);
if (!$auth-&gt;isValid()) {
    exit;
}
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>Today‚Äôs challenge contains a Doctrine Query Language (DQL) injection vulnerability, located in line 19.</p>
  </li>
  <li>
    <p>DQL injection is similar to SQL injection but more limited. In this case, the <code class="language-plaintext highlighter-rouge">where()</code> method of Doctrine is vulnerable.</p>
  </li>
  <li>
    <p>In lines 13 and 14, sanitization is applied to the input, but the <code class="language-plaintext highlighter-rouge">sanitizeInput()</code> method contains a bug.</p>
  </li>
  <li>
    <p>The method uses <code class="language-plaintext highlighter-rouge">addslashes()</code> to escape relevant characters by adding a backslash (<code class="language-plaintext highlighter-rouge">\</code>) in front of them. However, this causes an issue when a backslash (<code class="language-plaintext highlighter-rouge">\</code>) is passed as input, as it gets escaped to <code class="language-plaintext highlighter-rouge">\\</code>.</p>
  </li>
  <li>
    <p>The <code class="language-plaintext highlighter-rouge">substr()</code> function is then used to truncate the string, which can result in an escaped backslash being cut off, leaving a single backslash (<code class="language-plaintext highlighter-rouge">\</code>) at the end of the string.</p>
  </li>
  <li>
    <p>This improperly escaped input can break the WHERE statement and allow an attacker to inject custom DQL syntax. For example, using the condition <code class="language-plaintext highlighter-rouge">OR 1=1</code>, which always evaluates to true, can bypass authentication:
<code class="language-plaintext highlighter-rouge">user=1234567890123456789\&amp;passwd;=%20OR%201=1-</code></p>
  </li>
  <li>
    <p>The resulting DQL query becomes:<br />
<code class="language-plaintext highlighter-rouge">user = '1234567890123456789\' AND password = ' OR 1=1-'</code></p>
  </li>
  <li>
    <p>The backslash confuses the quotes, enabling DQL injection into the password value.</p>
  </li>
  <li>
    <p>The resulting query is technically invalid due to the trailing slash, but Doctrine automatically closes the last single quote, resulting in the final query:<br />
<code class="language-plaintext highlighter-rouge">OR 1=1-''</code></p>
  </li>
  <li>
    <p>To prevent DQL injections, always use bound parameters for dynamic conditions and avoid using <code class="language-plaintext highlighter-rouge">addslashes()</code> or similar functions to secure queries.</p>
  </li>
  <li>
    <p>Additionally, store passwords in a hashed format (e.g., BCrypt) in the database.</p>
  </li>
</ul>

<h3 id="challenge-14---snowman"><span class="mr-2">Challenge 14 - Snowman</span><a href="#challenge-14---snowman" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>class Carrot {
    const EXTERNAL_DIRECTORY = '/tmp/';
    private $id;
    private $lost = 0;
    private $bought = 0;

    public function __construct($input) {
        $this-&gt;id = rand(1, 1000);

        foreach ($input as $field =&gt; $count) {
            $this-&gt;$field = $count++;
        }
    }

    public function __destruct() {
        file_put_contents(
            self::EXTERNAL_DIRECTORY . $this-&gt;id,
            var_export(get_object_vars($this), true)
        );
    }
}

$carrot = new Carrot($_GET);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>
    <p>This class is vulnerable to <strong>directory traversal</strong> due to <strong>mass assignment</strong>.</p>
  </li>
  <li>
    <p>The constructor (line 11) allows arbitrary class attributes to be set via user input. By overwriting the <code class="language-plaintext highlighter-rouge">$id</code> attribute, an attacker can control the first parameter of <code class="language-plaintext highlighter-rouge">file_put_contents()</code> in line 16.</p>
  </li>
  <li>
    <p>By using <code class="language-plaintext highlighter-rouge">../</code>, the attacker can target arbitrary files on the system that are writable, potentially allowing them to create a PHP shell in the document root.</p>
  </li>
  <li>
    <p>The class assigns and increments values in line 11. However, the incrementation happens <strong>after</strong> the assignment, meaning the class attribute still holds the <strong>original value</strong> of <code class="language-plaintext highlighter-rouge">$count</code> after the operation.</p>
  </li>
  <li>To prevent this security issue:
    <ul>
      <li>Be <strong>very cautious</strong> when using reflection to set variables based on user input.</li>
      <li>Implement a <strong>whitelist verification</strong> that only allows specific variable names to be modified.</li>
    </ul>
  </li>
  <li>A real-world example of a vulnerability caused by mass assignment can be found <a href="https://web.archive.org/web/20171224161253/https://blog.ripstech.com/2016/the-state-of-wordpress-security/#podlove-publisher">here</a>.</li>
</ul>

<h3 id="challenge-15---sleigh-ride"><span class="mr-2">Challenge 15 - Sleigh Ride</span><a href="#challenge-15---sleigh-ride" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre>class Redirect {
    private $websiteHost = 'www.example.com';

    private function setHeaders($url) {
        $url = urldecode($url);
        header("Location: $url");
    }

    public function startRedirect($params) {
        $parts = explode('/', $_SERVER['PHP_SELF']);
        $baseFile = end($parts);
        $url = sprintf(
            "%s?%s",
            $baseFile,
            http_build_query($params)
        );
        $this-&gt;setHeaders($url);
    }
}

if ($_GET['redirect']) {
    (new Redirect())-&gt;startRedirect($_GET['params']);
}
</pre></td></tr></tbody></table></code></div></div>

<p>This challenge contains an open redirect vulnerability in line 6.</p>

<p>The code:</p>
<ul>
  <li>Takes input from the <code class="language-plaintext highlighter-rouge">$_SERVER['PHP_SELF']</code> superglobal.</li>
  <li>Splits the input at the slash character (<code class="language-plaintext highlighter-rouge">/</code>) on line 10.</li>
  <li>Uses the last part to construct a new URL.</li>
  <li>Passes the new URL to the <code class="language-plaintext highlighter-rouge">header()</code> function.</li>
</ul>

<p>An attacker can exploit this vulnerability by injecting a malicious URL using URL-encoded characters, which are decoded on line 5.</p>

<p>A possible payload could look like this: <code class="language-plaintext highlighter-rouge">/index.php/http:%252f%252fwww.domain.com?redirect=1</code></p>

<p><strong>Impact:</strong></p>
<ul>
  <li><strong>Phishing Attacks:</strong> Redirecting users to malicious sites disguised as the original site.</li>
  <li><strong>Credential Theft:</strong> Tricking users into entering their credentials on fake login pages.</li>
</ul>

<h3 id="challenge-16---poem"><span class="mr-2">Challenge 16 - Poem</span><a href="#challenge-16---poem" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre>class FTP {
    public $sock;

    public function __construct($host, $port, $user, $pass) {
        $this-&gt;sock = fsockopen($host, $port);

        $this-&gt;login($user, $pass);
        $this-&gt;cleanInput();
        $this-&gt;mode($_REQUEST['mode']);
        $this-&gt;send($_FILES['file']);
    }

    private function cleanInput() {
        $_GET = array_map('intval', $_GET);
        $_POST = array_map('intval', $_POST);
        $_COOKIE = array_map('intval', $_COOKIE);
    }

    public function login($username, $password) {
        fwrite($this-&gt;sock, "USER " . $username . "\n");
        fwrite($this-&gt;sock, "PASS " . $password . "\n");
    }

    public function mode($mode) {
        if ($mode == 1 || $mode == 2 || $mode == 3) {
            fputs($this-&gt;sock, "MODE $mode\n");
        }
    }

    public function send($data) {
        fputs($this-&gt;sock, $data);
    }
}

new FTP('localhost', 21, 'user', 'password');
</pre></td></tr></tbody></table></code></div></div>

<p>This challenge presents two vulnerabilities that, when combined, allow for data injection into an open FTP connection.</p>

<p><strong>Bug #1: Incomplete Sanitization (Line 9)</strong></p>

<ul>
  <li>The code utilizes <code class="language-plaintext highlighter-rouge">$_REQUEST</code> in line 9 to capture user input.</li>
  <li>Lines 14-16 sanitize only <code class="language-plaintext highlighter-rouge">$_GET</code> and <code class="language-plaintext highlighter-rouge">$_POST</code>, neglecting <code class="language-plaintext highlighter-rouge">$_COOKIE</code> data.</li>
  <li>Crucially, <code class="language-plaintext highlighter-rouge">$_REQUEST</code> is a combined copy of these inputs, not a reference.</li>
  <li>This incomplete sanitization leaves <code class="language-plaintext highlighter-rouge">$_REQUEST</code> vulnerable to malicious content.</li>
</ul>

<p><strong>Real-World Impact:</strong></p>

<p>A similar vulnerability in WordPress security is documented on our blog (archived link: <a href="https://web.archive.org/web/20171224161253/https://blog.ripstech.com/2016/the-state-of-wordpress-security/#all-in-one-wp-security-firewall">https://web.archive.org/web/20171224161253/https://blog.ripstech.com/2016/the-state-of-wordpress-security/#all-in-one-wp-security-firewall</a>).</p>

<p><strong>Bug #2: Type Juggling with == (Line 25)</strong></p>

<ul>
  <li>Line 25 employs the type-unsafe comparison operator <code class="language-plaintext highlighter-rouge">==</code> instead of the strict comparison <code class="language-plaintext highlighter-rouge">===</code>.</li>
  <li>This allows attackers to inject malicious code through type juggling.</li>
  <li>Example Payload: <code class="language-plaintext highlighter-rouge">?mode=1%0a%0dDELETE%20test.file</code>
    <ul>
      <li>Decoded, the payload injects a ‚ÄúDELETE‚Äù command potentially wiping out a file named ‚Äútest.file‚Äù.</li>
    </ul>
  </li>
</ul>

<p><strong>Combined Impact:</strong></p>

<p>These vulnerabilities enable attackers to:</p>

<ul>
  <li>Inject arbitrary commands into the FTP connection.</li>
  <li>Potentially manipulate or steal sensitive data.</li>
</ul>

<h3 id="challenge-17---mistletoe"><span class="mr-2">Challenge 17 - Mistletoe</span><a href="#challenge-17---mistletoe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre></td><td class="rouge-code"><pre>class RealSecureLoginManager {
    private $em;
    private $user;
    private $password;

    public function __construct($user, $password) {
        $this-&gt;em = DoctrineManager::getEntityManager();
        $this-&gt;user = $user;
        $this-&gt;password = $password;
    }

    public function isValid() {
        $pass = md5($this-&gt;password, true);
        $user = $this-&gt;sanitizeInput($this-&gt;user);

        $queryBuilder = $this-&gt;em-&gt;createQueryBuilder()
            -&gt;select("COUNT(p)")
            -&gt;from("User", "u")
            -&gt;where("password = '$pass' AND user = '$user'");
        $query = $queryBuilder-&gt;getQuery();
        return boolval($query-&gt;getSingleScalarResult());
    }

    public function sanitizeInput($input) {
        return addslashes($input);
    }
}

$auth = new RealSecureLoginManager(
    $_POST['user'],
    $_POST['passwd']
);
if (!$auth-&gt;isValid()) {
    exit;
}
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The challenge is intended to be a fixed version of Day 13 but inadvertently introduces new security flaws.</li>
  <li>The author attempted to address the DQL injection by using <code class="language-plaintext highlighter-rouge">addslashes()</code> on the username but forgot to use <code class="language-plaintext highlighter-rouge">substr()</code>.</li>
  <li>The password was hashed using <code class="language-plaintext highlighter-rouge">md5()</code> on line 13, which is not recommended for secure password storage.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">md5()</code> is not secure for password hashing and should be avoided.</li>
      <li>Password hashes should not be directly compared.</li>
      <li>The second parameter for <code class="language-plaintext highlighter-rouge">md5()</code> is set to <code class="language-plaintext highlighter-rouge">true</code>, returning the hash in binary format, which can contain ASCII characters.</li>
    </ul>
  </li>
  <li>When the hash is binary, Doctrine may misinterpret certain characters, leading to potential issues.
    <ul>
      <li>In this case, an attacker could use <code class="language-plaintext highlighter-rouge">128</code> as the password, resulting in a hash like <code class="language-plaintext highlighter-rouge">vÔøΩanÔøΩÔøΩÔøΩlÔøΩÔøΩÔøΩqÔøΩÔøΩ\</code>, where the backslash escapes a single quote, enabling a DQL injection.</li>
      <li>A potential attack could use this payload: <code class="language-plaintext highlighter-rouge">?user=%20OR%201=1-&amp;passwd;=128</code>.</li>
    </ul>
  </li>
  <li>To prevent DQL injections, always use bound parameters for dynamic conditions in queries.</li>
  <li>Never attempt to ‚Äúsecure‚Äù a DQL query with <code class="language-plaintext highlighter-rouge">addslashes()</code> or similar functions.</li>
  <li>Passwords should be hashed using a secure algorithm, such as <code class="language-plaintext highlighter-rouge">BCrypt</code>, rather than insecure methods like <code class="language-plaintext highlighter-rouge">md5()</code>.</li>
</ul>

<h3 id="challenge-18---sign"><span class="mr-2">Challenge 18 - Sign</span><a href="#challenge-18---sign" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>class JWT {
    public function verifyToken($data, $signature) {
        $pub = openssl_pkey_get_public("file://pub_key.pem");
        $signature = base64_decode($signature);
        if (openssl_verify($data, $signature, $pub)) {
            $object = json_decode(base64_decode($data));
            $this-&gt;loginAsUser($object);
        }
    }
}

(new JWT())-&gt;verifyToken($_GET['d'], $_GET['s']);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The challenge includes a bug in the use of the <code class="language-plaintext highlighter-rouge">openssl_verify()</code> function on line 5, which causes an authentication bypass on line 7.</li>
  <li>The <code class="language-plaintext highlighter-rouge">openssl_verify()</code> function returns three possible values:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">1</code> if the signature is correct,</li>
      <li><code class="language-plaintext highlighter-rouge">0</code> if the signature verification fails,</li>
      <li><code class="language-plaintext highlighter-rouge">-1</code> if an error occurs during the verification process.</li>
    </ul>
  </li>
  <li>The issue arises when an attacker generates a valid signature using a different algorithm than the one used by <code class="language-plaintext highlighter-rouge">pub_key.pem</code>.
    <ul>
      <li>In this case, <code class="language-plaintext highlighter-rouge">openssl_verify()</code> returns <code class="language-plaintext highlighter-rouge">-1</code>, which is automatically cast to <code class="language-plaintext highlighter-rouge">true</code>, bypassing the authentication check.</li>
    </ul>
  </li>
  <li>To resolve this, use a type-safe comparison (<code class="language-plaintext highlighter-rouge">===</code>) to validate the return value of <code class="language-plaintext highlighter-rouge">openssl_verify()</code>.</li>
  <li>Alternatively, consider using a more secure cryptography library to handle signature verification.</li>
</ul>

<h3 id="challenge-19---birch"><span class="mr-2">Challenge 19 - Birch</span><a href="#challenge-19---birch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>class ImageViewer {
    private $file;

    function __construct($file) {
        $this-&gt;file = "images/$file";
        $this-&gt;createThumbnail();
    }

    function createThumbnail() {
        $e = stripcslashes(
            preg_replace(
                '/[^0-9\\\]/',
                '',
                isset($_GET['size']) ? $_GET['size'] : '25'
            )
        );
        system("/usr/bin/convert {$this-&gt;file} --resize $e
                ./thumbs/{$this-&gt;file}");
    }

    function __toString() {
        return "&lt;a href={$this-&gt;file}&gt;
                &lt;img src=./thumbs/{$this-&gt;file}&gt;&lt;/a&gt;";
    }
}

echo (new ImageViewer("image.png"));
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">ImageViewer</code> class is vulnerable to remote command execution via the <code class="language-plaintext highlighter-rouge">size</code> parameter on line 17.</li>
  <li>The <code class="language-plaintext highlighter-rouge">preg_replace()</code> function is used to remove most non-digit characters, but this is not enough to prevent exploitation.</li>
  <li>The <code class="language-plaintext highlighter-rouge">stripcslashes()</code> function not only removes slashes but also converts C literal escape sequences into their actual byte values.
    <ul>
      <li>This leaves the backslash character unaffected by <code class="language-plaintext highlighter-rouge">preg_replace()</code>, allowing an attacker to inject an octal byte escape sequence like <code class="language-plaintext highlighter-rouge">0\073\163\154\145\145\160\0405\073</code>.</li>
    </ul>
  </li>
  <li>The <code class="language-plaintext highlighter-rouge">stripcslashes()</code> function will evaluate the input to <code class="language-plaintext highlighter-rouge">0;sleep 5;</code>, which gets appended to the system command and executed by the attacker.</li>
</ul>

<h3 id="challenge-20---stocking"><span class="mr-2">Challenge 20 - Stocking</span><a href="#challenge-20---stocking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre>set_error_handler(function ($no, $str, $file, $line) {
    throw new ErrorException($str, 0, $no, $file, $line);
}, E_ALL);

class ImageLoader
{
    public function getResult($uri)
    {
        if (!filter_var($uri, FILTER_VALIDATE_URL)) {
            return '&lt;p&gt;Please enter valid uri&lt;/p&gt;';
        }

        try {
            $image = file_get_contents($uri);
            $path = "./images/" . uniqid() . '.jpg';
            file_put_contents($path, $image);
            if (mime_content_type($path) !== 'image/jpeg') {
                unlink($path);
                return '&lt;p&gt;Only .jpg files allowed&lt;/p&gt;';
            }
        } catch (Exception $e) {
            return '&lt;p&gt;There was an error: ' .
                $e-&gt;getMessage() . '&lt;/p&gt;';
        }

        return '&lt;img src="' . $path . '" width="100"/&gt;';
    }
}

echo (new ImageLoader())-&gt;getResult($_GET['img']);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>This challenge contains a server-side request forgery (SSRF) vulnerability that allows an attacker to make requests on behalf of the targeted web server.</li>
  <li>This enables the attacker to access servers that would otherwise be unreachable from the outside, such as internal systems behind the web server.
    <ul>
      <li>For example, an attacker could use this vulnerability to conduct a port scan or retrieve banners (like server versions) from internal services.</li>
    </ul>
  </li>
  <li>The vulnerability is caused by two factors:
    <ul>
      <li>The use of <code class="language-plaintext highlighter-rouge">file_get_contents()</code> with unfiltered user input on line 14.</li>
      <li>The printing of error messages to the user on line 23.</li>
    </ul>
  </li>
  <li>An attacker could exploit this by providing an internal URI like <code class="language-plaintext highlighter-rouge">?img=http://internal:22</code>, which would return a response such as <code class="language-plaintext highlighter-rouge">failed to open stream: HTTP request failed! SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.2</code> if OpenSSH is running.
    <ul>
      <li>This kind of information can aid in further attacks.</li>
    </ul>
  </li>
  <li>Another common attack scenario is retrieving sensitive AWS credentials when exploiting an AWS cloud instance.</li>
  <li>Additionally, <code class="language-plaintext highlighter-rouge">filter_var()</code> accepts <code class="language-plaintext highlighter-rouge">file://</code> URLs, which can allow an attacker to load local files.</li>
</ul>

<h3 id="challenge-21---gift-wrap"><span class="mr-2">Challenge 21 - Gift Wrap</span><a href="#challenge-21---gift-wrap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>declare(strict_types=1);

class ParamExtractor {
    private $validIndices = [];

    private function indices($input) {
        $validate = function (int $value, $key) {
            if ($value &gt; 0) {
                $this-&gt;validIndices[] = $key;
            }
        };

        try {
            array_walk($input, $validate, 0);
        } catch (TypeError $error) {
            echo "Only numbers are allowed as input";
        }

        return $this-&gt;validIndices;
    }

    public function getCommand($parameters) {
        $indices = $this-&gt;indices($parameters);
        $params = [];
        foreach ($indices as $index) {
            $params[] = $parameters[$index];
        }
        return implode($params, ' ');
    }
}

$cmd = (new ParamExtractor())-&gt;getCommand($_GET['p']);
system('resizeImg image.png ' . $cmd);
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>This challenge contains a command injection vulnerability on line 33.</li>
  <li>The developer enabled <code class="language-plaintext highlighter-rouge">strict_types=1</code> on line 1 to enforce type hints in the <code class="language-plaintext highlighter-rouge">validate</code> function (line 7), ensuring that a <code class="language-plaintext highlighter-rouge">TypeError</code> is thrown if a non-integer value is passed.</li>
  <li>Despite strict typing being enabled, there is a bug in the use of <code class="language-plaintext highlighter-rouge">array_walk()</code>, which bypasses strict typing and instead uses PHP‚Äôs default weak typing.</li>
  <li>As a result, an attacker can append a command to the last parameter, which will be executed in the system call.
    <ul>
      <li>A possible exploit could look like <code class="language-plaintext highlighter-rouge">?p[1]=1&amp;p[2]=2;%20ls%20-la</code>.</li>
    </ul>
  </li>
</ul>

<h3 id="challenge-22---chimney"><span class="mr-2">Challenge 22 - Chimney</span><a href="#challenge-22---chimney" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>if (isset($_POST['password'])) {
    setcookie('hash', md5($_POST['password']));
    header("Refresh: 0");
    exit;
}

$password = '0e836584205638841937695747769655';
if (!isset($_COOKIE['hash'])) {
    echo '&lt;form&gt;&lt;input type="password" name="password" /&gt;'
       . '&lt;input type="submit" value="Login" &gt;&lt;/form &gt;';
    exit;
} elseif (md5($_COOKIE['hash']) == $password) {
    echo 'Login succeeded';
} else {
    echo 'Login failed';
}
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The code snippet has four vulnerabilities:
    <ol>
      <li><strong>Type-unsafe comparison</strong>: On line 12, the hashed password is compared to a string using a type-unsafe operator. The string is in scientific notation and is interpreted as ‚Äúzero to the power of X‚Äù, which results in zero. If an attacker can generate a zero-string for the hashed user input, the comparison will succeed.
        <ul>
          <li>These hashes are known as ‚ÄúMagic Hashes.‚Äù A Google search reveals that the MD5 hash of <code class="language-plaintext highlighter-rouge">240610708</code> produces the desired properties.</li>
        </ul>
      </li>
      <li><strong>Hashing issue</strong>: The password hash is calculated twice, which prevents directly submitting the value. The second vulnerability arises because the first hash is calculated on the server but stored in a cookie on the client side. The attacker can inject the value <code class="language-plaintext highlighter-rouge">240610708</code> directly into the password cookie to bypass the check.</li>
      <li><strong>Timing attack vulnerability</strong>: The comparison of the hashes is vulnerable to timing attacks. To mitigate this, the <code class="language-plaintext highlighter-rouge">hash_equals()</code> function should be used for secure comparison.</li>
      <li><strong>Weak password hashing</strong>: The code uses the MD5 algorithm to hash the password, which is considered broken and not suitable for password storage. A more secure algorithm like <code class="language-plaintext highlighter-rouge">BCrypt</code> should be used for hashing passwords.</li>
    </ol>
  </li>
  <li>Additionally, passwords should not be hardcoded in the code but should be stored in a configuration file for better security.</li>
</ul>

<h3 id="challenge-23---cookies"><span class="mr-2">Challenge 23 - Cookies</span><a href="#challenge-23---cookies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>class LDAPAuthenticator {
    public $conn;
    public $host;

    function __construct($host = "localhost") {
        $this-&gt;host = $host;
    }

    function authenticate($user, $pass) {
        $result = [];
        $this-&gt;conn = ldap_connect($this-&gt;host);    
        ldap_set_option(
            $this-&gt;conn,
            LDAP_OPT_PROTOCOL_VERSION,
            3
        );
        if (!@ldap_bind($this-&gt;conn))
            return -1;
        $user = ldap_escape($user, null, LDAP_ESCAPE_DN);
        $pass = ldap_escape($pass, null, LDAP_ESCAPE_DN);
        $result = ldap_search(
            $this-&gt;conn,
            "",
            "(&amp;(uid=$user)(userPassword=$pass))"
        );
        $result = ldap_get_entries($this-&gt;conn, $result);
        return ($result["count"] &gt; 0 ? 1 : 0);
    }
}

if(isset($_GET["u"]) &amp;&amp; isset($_GET["p"])) {
    $ldap = new LDAPAuthenticator();
    if ($ldap-&gt;authenticate($_GET["u"], $_GET["p"])) {
        echo "You are now logged in!";
    } else {
        echo "Username or password unknown!";
    }
}
</pre></td></tr></tbody></table></code></div></div>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">LDAPAuthenticator</code> class is vulnerable to an LDAP injection on line 24.</li>
  <li>By injecting special characters into the username, an attacker can manipulate the LDAP query‚Äôs result set.</li>
  <li>Although the <code class="language-plaintext highlighter-rouge">ldap_escape()</code> function is used to sanitize input on lines 19 and 20, an incorrect flag is passed to the function, leading to improper sanitization.</li>
  <li>As a result, the LDAP injection allows an unauthenticated attacker to bypass the authentication mechanism.
    <ul>
      <li>In this case, the attacker can inject the asterisk wildcard <code class="language-plaintext highlighter-rouge">*</code> as both the username and password to successfully authenticate as any user.</li>
    </ul>
  </li>
</ul>

<h3 id="challenge-24---nutcracker"><span class="mr-2">Challenge 24 - Nutcracker</span><a href="#challenge-24---nutcracker" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>@$GLOBALS=$GLOBALS{next}=next($GLOBALS{'GLOBALS'})
[$GLOBALS['next']['next']=next($GLOBALS)['GLOBALS']]
[$next['GLOBALS']=next($GLOBALS[GLOBALS]['GLOBALS'])
[$next['next']]][$next['GLOBALS']=next($next['GLOBALS'])]
[$GLOBALS[next]['next']($GLOBALS['next']{'GLOBALS'})]=
next(neXt(${'next'}['next']));
</pre></td></tr></tbody></table></code></div></div>
<ul>
  <li>This challenge involves a code snippet created by one of our team members for the Hack.lu CTF Tournament.</li>
  <li>The code relies heavily on the <code class="language-plaintext highlighter-rouge">next()</code> function and the <code class="language-plaintext highlighter-rouge">$GLOBALS</code> array:
    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">next()</code> function advances the internal array pointer by one position.</li>
      <li>Combined with the <code class="language-plaintext highlighter-rouge">$GLOBALS</code> array, this setup allows for the execution of arbitrary code.</li>
    </ul>
  </li>
  <li>The payload is divided into two parts:
    <ol>
      <li>The first part is a PHP function to execute, passed via <code class="language-plaintext highlighter-rouge">$_COOKIE['GLOBALS']</code>.</li>
      <li>The second part consists of parameters for the function, injected through the file type of a file sent with the same name as the PHP function.</li>
    </ol>
  </li>
  <li>For a more detailed explanation of the solution, you can refer to this write-up:<br />
<a href="https://web.archive.org/web/20171224161253/https://github.com/ctfs/write-ups-2014/tree/master/hack-lu-ctf-2014/next-global-backdoor">Hack.lu CTF 2014 - Next Global Backdoor Write-Up</a></li>
</ul>

<p>Link to archived writeup:</p>

<ul>
  <li><a href="https://web.archive.org/web/20171224161253/https://www.ripstech.com/php-security-calendar-2017/">Reference</a></li>
</ul>

</div>

<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
  <div class="post-meta mb-3">
    <i class="far fa-folder-open fa-fw mr-1"></i>
    
      <a href='/categories/capture-the-flag/'>capture the flag</a>
  </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw mr-1"></i>
      
      <a href="/tags/ctf/"
          class="post-tag no-text-decoration" >ctf</a>
      
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">

      

        

        This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.

      
    </div>

    <!--
 Post sharing snippet
-->

<div class="share-wrapper">
  <span class="share-label text-muted mr-1">Share</span>
  <span class="share-icons">
    
    
    

    
      
        <a href="https://x.com/snoopysecurity?lang=en-GB" data-toggle="tooltip" data-placement="top"
          title="Twitter" target="_blank" rel="noopener" aria-label="Twitter">
          <i class="fa-fw fab fa-twitter"></i>
        </a>
    
      
        <a href="https://x.com/snoopysecurity?lang=en-GB" data-toggle="tooltip" data-placement="top"
          title="Facebook" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-fw fab fa-facebook-square"></i>
        </a>
    
      
        <a href="https://www.linkedin.com/in/sam-sanoop-b80535252/" data-toggle="tooltip" data-placement="top"
          title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin">
          <i class="fa-fw fab fa-linkedin"></i>
        </a>
    

    <i id="copy-link" class="fa-fw fas fa-link small"
        data-toggle="tooltip" data-placement="top"
        title="Copy link"
        data-title-succeed="Link copied successfully!">
    </i>

  </span>
</div>


  </div><!-- .post-tail-bottom -->

</div><!-- div.post-tail-wrapper -->


      
    
    

    </div>
  </div> <!-- #core-wrapper -->

  <!-- panel -->
  <div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">

    <div class="access">
      















  <div id="access-lastmod" class="post">
    <div class="panel-heading">Recently Updated</div>
    <ul class="post-content pl-0 pb-1 ml-1 mt-2">
      
        
        
        
      <li><a href="/posts/chef-unsafe-deserialization/">Chef Yaml Deserialization Vulnerability</a></li>
      
        
        
        
      <li><a href="/posts/code-security-advent-calendar-answers/">Code Security Advent Calendar 2020 Answers</a></li>
      
        
        
        
      <li><a href="/posts/avoiding-smtp-injection/">Avoiding SMTP Injection: A Whitebox primer</a></li>
      
    </ul>
  </div> <!-- #access-lastmod -->



      















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/ctf/">ctf</a>
    
      
      <a class="post-tag" href="/tags/php-deserialization/">php deserialization</a>
    
      
      <a class="post-tag" href="/tags/yaml/">yaml</a>
    
      
      <a class="post-tag" href="/tags/exploit-education/">exploit education</a>
    
      
      <a class="post-tag" href="/tags/facebook-ctf/">facebook ctf</a>
    
      
      <a class="post-tag" href="/tags/zip-slip/">zip slip</a>
    
      
      <a class="post-tag" href="/tags/code-security-advent-calendar/">code security advent calendar</a>
    
      
      <a class="post-tag" href="/tags/domgoat/">domgoat</a>
    
      
      <a class="post-tag" href="/tags/drozer/">drozer</a>
    
      
      <a class="post-tag" href="/tags/ghost-xss/">ghost xss</a>
    

    </div>
  </div>


    </div>

    
      
      



<!-- BS-toc.js will be loaded at medium priority -->
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script>

<div id="toc-wrapper" class="pl-0 pr-4 mb-5">
  <div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
  <nav id="toc" data-toggle="toc"></nav>
</div>


    
  </div>

</div>

<!-- tail -->

<div class="row">
  <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5">
    
      
      <!--
 Recommend the other 3 posts according to the tags and categories of the current post,
 if the number is not enough, use the other latest posts to supplement.
-->

<!-- The total size of related posts  -->


<!-- An random integer that bigger than 0  -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy}  -->








  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  
    
  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  


  

  

  

  

  

  








<!-- Fill with the other newlest posts  -->





  <div id="related-posts" class="mb-2 mb-sm-4">
    <h3 class="pt-2 mb-4 ml-1"
      data-toc-skip>Further Reading</h3>
    <div class="card-deck mb-4">
    
      
      
      <div class="card">
        <a href="/posts/ripstech-java-advent-calendar/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1578425152"
    data-df="ll"
    >
  Jan  8, 2020
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>RipsTech Java Security Calendar 2019 Notes</h3>
            <div class="text-muted small">
              <p>
                





                Notes related to RipsTech PHP Security Calendar 2019 which aren‚Äôt accessible anymore.

Challenge 1 - Candy Cane

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/code-advent-2021-security-challenges/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1641065152"
    data-df="ll"
    >
  Jan  2, 2022
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>SonarSource CodeAdvent Security Calendar 2021 Notes</h3>
            <div class="text-muted small">
              <p>
                





                Notes related to RipsTech/SonarSource CodeAdvent Security Calendar 2021.

Day 1




  
    Line 13: The code registers a handler for message events and writes the event‚Äôs data directly into the DOM...
              </p>
            </div>
          </div>
        </a>
      </div>
    
      
      
      <div class="card">
        <a href="/posts/codesecurity-advent-calendar-2022/">
          <div class="card-body">
            <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->





<em class="small"
    data-ts="1672601152"
    data-df="ll"
    >
  Jan  2, 2023
</em>

            <h3 class="pt-0 mt-1 mb-3" data-toc-skip>SonarSource Advent Security Calendar 2022 Notes</h3>
            <div class="text-muted small">
              <p>
                





                Notes related to RipsTech/SonarSource CodeAdvent Security Calendar 2022. Official writeup here: https://www.sonarsource.com/knowledge/code-challenges/advent-calendar-2022/

Day 1 - PHP

1
2
3
4
5
6...
              </p>
            </div>
          </div>
        </a>
      </div>
    
    </div> <!-- .card-deck -->
  </div> <!-- #related-posts -->


    
      
      <!--
  Navigation buttons at the bottom of the post.
-->

<div class="post-navigation d-flex justify-content-between">
  
  <a href="/posts/introduction_to_socat/" class="btn btn-outline-primary"
    prompt="Older">
    <p>Introduction to Socat</p>
  </a>
  

  
  <a href="/posts/target_blank_vulnerability/" class="btn btn-outline-primary"
    prompt="Newer">
    <p>The target="_blank" Vulnerability</p>
  </a>
  

</div>

    
      
      <!--  The comments switcher -->


    
  </div>
</div>


      </div>

      <!--
  The Search results
-->
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-12 col-sm-11 post-content">
    <div id="search-hints">
      















  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <div id="access-tags">
    <div class="panel-heading">Trending Tags</div>
    <div class="d-flex flex-wrap mt-3 mb-1 mr-3">

    
      
      <a class="post-tag" href="/tags/ctf/">ctf</a>
    
      
      <a class="post-tag" href="/tags/php-deserialization/">php deserialization</a>
    
      
      <a class="post-tag" href="/tags/yaml/">yaml</a>
    
      
      <a class="post-tag" href="/tags/exploit-education/">exploit education</a>
    
      
      <a class="post-tag" href="/tags/facebook-ctf/">facebook ctf</a>
    
      
      <a class="post-tag" href="/tags/zip-slip/">zip slip</a>
    
      
      <a class="post-tag" href="/tags/code-security-advent-calendar/">code security advent calendar</a>
    
      
      <a class="post-tag" href="/tags/domgoat/">domgoat</a>
    
      
      <a class="post-tag" href="/tags/drozer/">drozer</a>
    
      
      <a class="post-tag" href="/tags/ghost-xss/">ghost xss</a>
    

    </div>
  </div>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>


    </div> <!-- #main-wrapper -->

    <!-- The Footer -->

<footer>
  <div class="container pl-lg-4 pr-lg-4">
    <div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3">
      <div class="footer-left">
        <p class="mb-0">
          ¬© 2025
          <a href="https://twitter.com/snoopysecurity">Sam Sanoop</a>.
          
          <span data-toggle="tooltip" data-placement="top"
            title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span>
          
        </p>
      </div>

      <div class="footer-right">
        <p class="mb-0">Using the <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> theme <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a>.
        </p>
      </div>
    </div>
  </div>
</footer>


    
      <!--
  mermaid-js loader
-->

<script src="https://cdn.jsdelivr.net/npm/mermaid@9.2.2/dist/mermaid.min.js"></script>

<script>
  (function () {

    function updateMermaid(event) {
      if (event.source === window && event.data &&
        event.data.direction === ModeToggle.ID) {

        const mode = event.data.message;

        if (typeof mermaid === "undefined") {
          return;
        }

        let expectedTheme = (mode === ModeToggle.DARK_MODE ? "dark" : "default");
        let config = {theme: expectedTheme};

        /* Re-render the SVG ‚Ä∫ <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */
        $(".mermaid").each(function () {
          let svgCode = $(this).prev().children().html();
          $(this).removeAttr("data-processed");
          $(this).html(svgCode);
        });

        mermaid.initialize(config);
        mermaid.init(undefined, ".mermaid");
      }
    }

    let initTheme = "default";

    if ($("html[data-mode=dark]").length > 0
      || ($("html[data-mode]").length == 0
        && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
      initTheme = "dark";
    }

    let mermaidConf = {
      theme: initTheme  /* <default|dark|forest|neutral> */
    };

    /* Create mermaid tag */
    $("pre").has("code.language-mermaid").each(function () {
      let svgCode = $(this).children().html();
      $(this).addClass("unloaded");
      $(this).after(`<pre class=\"mermaid\">${svgCode}</pre>`);
    });

    mermaid.initialize(mermaidConf);

    window.addEventListener("message", updateMermaid);
  })();

</script>

    

    <div id="mask"></div>

    <a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button">
      <i class="fas fa-angle-up"></i>
    </a>

    
      <div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true"
        data-animation="true" data-autohide="false">
        <div class="toast-header">
          <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="toast-body text-center pt-0">
          <p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
          <button type="button" class="btn btn-primary" aria-label="Update">
            Update
          </button>
        </div>
      </div>
    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script>

<script>
SimpleJekyllSearch({
  searchInput: document.getElementById('search-input'),
  resultsContainer: document.getElementById('search-results'),
  json: '/assets/js/data/search.json',
  searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0">  <a href="{url}">{title}</a>  <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">    {categories}    {tags}  </div>  <p>{snippet}</p></div>',
  noResultsText: '<p class="mt-5">Oops! No results found.</p>',
  templateMiddleware: function(prop, value, template) {
    if (prop === 'categories') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
      }
    }

    if (prop === 'tags') {
      if (value === '') {
        return `${value}`;
      } else {
        return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
      }
    }
  }
});
</script>


    <!--
  JS selector for site.
-->

<!-- layout specified -->


  



  <!-- image lazy-loading & popup & clipboard -->
  

  







  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js"></script>






  

  

  







  
    

    

  



  
    

    

  



  
    

    

  



  
    

    

  




  <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js"></script>








<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script>
  /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */
  MathJax = {
    tex: {
      inlineMath: [              /* start/end delimiter pairs for in-line math */
        ['$','$'],
        ['\\(','\\)']
      ],
      displayMath: [             /* start/end delimiter pairs for display math */
        ['$$', '$$'],
        ['\\[', '\\]']
      ]
    }
  };
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js">
  </script>


<!-- commons -->

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>




  </body>

</html>

