<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>6 things I didn't know Drozer could do</title>
  <meta name="description" content="1 : Intent Sniffing">
  
  <meta name="author" content="Sam Sanoop">
  <meta name="copyright" content="&copy; Sam Sanoop 2022">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <!--<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/.min.css"> -->
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  <
  
  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="1 : Intent Sniffing" />
  <meta property="og:url" content="http://localhost:4000/mobile-security/2015/10/23/six-things-you-didnt-know-Drozer-could-do.html">
  <meta property="og:site_name" content="ðŸ’» | Blog" />
  <meta property="og:title" content="6 things I didn't know Drozer could do" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://localhost:4000/assets/logo.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="6 things I didn't know Drozer could do">
  <meta name="twitter:description" content="1 : Intent Sniffing">
  <meta name="twitter:image" content="http://localhost:4000/assets/logo.png">
  <meta name="twitter:url" content="http://localhost:4000/mobile-security/2015/10/23/six-things-you-didnt-know-Drozer-could-do.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/mobile-security/2015/10/23/six-things-you-didnt-know-Drozer-could-do.html">
	<link rel="alternate" type="application/rss+xml" title="ðŸ’» | Blog" href="http://localhost:4000/feed.xml" />
	
	<!-- Tooltips -->
	<script type="text/javascript">
		window.tooltips = []
	</script>
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="ðŸ’» | Blog">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	
	<li class="nav-link"><a href="/wallofsheep/">Wall Of Sheep</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">6 things I didn't know Drozer could do</h1>
      <p class="info">by <strong>snoopysecurity</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">October 23, 2015</div>
  <div class="post-categories">
  in 
    
    <a href="/category/mobile-security">Mobile-security</a>
    
  
  </div>
</section>

<article class="post-content">
  <h3 id="1--intent-sniffing">1 : Intent Sniffing</h3>

<p>Intent sniffing is an attack vector use to capture exposed intents. In certain cases, applications will broadcast intents and will not define any permissions that in need to receive the intent. This can then be captured by a malicious application. So passing sensitive data via Intents might potentially be dangerous. A popular tool used by most consultants (Link here)[https://www.nccgroup.trust/us/about-us/resources/intent-sniffer/)] called intent sniffer can be used. But it is possible to test for this vulnerability using Drozer.</p>

<p>Drozer has a module called</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.broadcast.sniff
</code></pre></div></div>

<p>which can be used to sniff rogue intents. The below example is Drozer capturing all intents sent to battery changed receiver.</p>

<h3 id="2--finding-debuggable-applications-quickly">2 : Finding debuggable applications quickly</h3>

<p>If application is marked as debuggable, then a user can step through code, view variable values, and pause execution of an application. This can be very useful for an attacker since he can try to run arbitrary code under that application permission, hook into certain methods and modify set variables.</p>

<p>Drozer has a module called</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.package.debuggable
</code></pre></div></div>

<p>which can be used to find exploitable applications. This simply looks for android:debuggable value in the AndroidManifest.xml but it is a more efficient way of searching for debuggable applications.</p>

<h3 id="3--finding-applications-with-backup-enabled">3 : Finding applications with backup enabled</h3>

<p>Android functionality allows backups and restoration of its data without having root permissions. This feature of android uses ADB backup that allows applications to be backed up to the cloud. This means that if a user replaces or wipes their phone, they can restore app settings. But if an attacker can get physical access to the device and take the backup of the app, he can modify the headers and restore it to the applicationâ€™s original state.</p>

<p>This is a low hanging vulnerability but it is still useful to find in applications. As always, the Drozer module run</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>app.package.backup
</code></pre></div></div>

<p>can be used to find applications with backup flag enabled in its manifest file.</p>

<h3 id="4--capturing-clipboard-content-with-drozer">4 : Capturing Clipboard content with Drozer</h3>

<p>All android mobile system has a clipboard which is used by all applications installed on the device. In certain scenarios, applications will store sensitive values such as passwords which can be read and altered by any application. More information about clipboard here: http://developer.android.com/reference/android/content/ClipboardManager.html</p>

<p>The drozer module <code class="highlighter-rouge">post.capture.clipboard</code> can be used to view clipboard content from any application. It should be noted that the clipboard module will need to be installed in Drozer first.</p>

<h3 id="5--addjavascriptinterface-arbitrary-code-execution">5 : AddJavaScriptInterface Arbitrary Code Execution</h3>

<p>The Add JavaScript Webview code execution is a vulnerability found in most applications. WebView supports usage of JavaScript which allows execution of remote code through a man in the middle attacker.</p>

<p>The Drozer module scanner.misc.checkjavascriptbridge can very useful when trying to identify the vulnerability. By running the command</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>run scanner.misc.checkjavascriptbridge
</code></pre></div></div>

<p>it is possible to identify vulnerable applications</p>

<h3 id="6--rebuilding-drozer-agent-with-permissions">6 : Rebuilding Drozer Agent with permissions</h3>

<p>By default, Drozer agent apk only comes with internet access permission. Sometimes you might have to rebuild Drozer agent with certain permissions for various tasks. e.g. Querying permission protected providers, testing custom permissions etc.</p>

<p>This can be done in command line by using</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Drozer agent build --permission android.permission.[PERMISSION YOU WANT]
</code></pre></div></div>
<p>This is easier than decompiling the app, making edits to the manifest and recompiling again.</p>

<h3 id="bonus--drozer-built-in-scanning-capabilities">Bonus : Drozer built in scanning capabilities</h3>

<p>Other useful commands that are worth knowing</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>scanner.provider.injection - Test content providers for SQL injection vulnerabilities.
scanner.provider.sqltables - Show all table names accessible through any SQL injection vulnerabilities.
scanner.provider.traversal - Test content providers for directory traversal.
scanner.misc.readablefiles &amp; writablefiles - Find world-readable files and world-writable files in the given folder. This is easier than browsing each possible directories and using 'ls -la' to see permissions.
scanner.provider.finduris - Search for content providers that can be queried.
</code></pre></div></div>

</article>





<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=6+things+I+didn%27t+know+Drozer+could+do&url=http%3A%2F%2Flocalhost%3A4000%2Fmobile-security%2F2015%2F10%2F23%2Fsix-things-you-didnt-know-Drozer-could-do.html&via=snoopysecurity"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fmobile-security%2F2015%2F10%2F23%2Fsix-things-you-didnt-know-Drozer-could-do.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
</section>

	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/web-application-security/2015/08/25/ZAP-Scripting.html">
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
					</span>
					<span class="page-number">ZAP Scripting</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/network-security/2018/03/21/introduction_to_socat.html">
					<span class="page-number">Introduction to Socat</span>
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
					</span>
				</a>
			
		</span>
	</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">ðŸ’» | Blog</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	
	<li class="nav-link"><a href="/wallofsheep/">Wall Of Sheep</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:@snoopysecurity">
            <i class="fa fa-envelope-o"></i>
            <span class="username">@snoopysecurity</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://twitter.com/snoopysecurity" title="Follow me on Twitter">
              <i class="fa fa-twitter"></i>
              <span class="username">snoopysecurity</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://github.com/snoopysecurity" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">snoopysecurity</span>
            </a>
          </li>
          
        
          
          <li>
            <a href="https://www.linkedin.com/pub/sam-sanoop/47/769/60a" title="Connect with me on LinkedIn">
              <i class="fa fa-linkedin"></i>
              <span class="username">Sam Sanoop</span>
            </a>
          </li>
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">Hack adventures while segfaulting through life
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"></script>
<script src="//unpkg.com/popper.js@1"></script>
<script src="//unpkg.com/tippy.js@5"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });

	// Enable tooltips via Tippy.js
	if (Array.isArray(window.tooltips)) {
		window.tooltips.forEach(function(tooltip) {
			var selector = tooltip[0];
			var config = tooltip[1];
			tippy(selector, config);
		})
	}
});

</script>






  </body>

</html>
